---
attack_technique: T1148
display_name: HISTCONTROL

atomic_tests:
- name: Disable history collection
  description: |
    Disables history collection in shells
  supported_platforms:
    - linux
    - macos
  input_arguments:
    evil_command:
        description: |
          xxx
        type: String
        default: whoami
    output_file:
      description: |
        xxx
      type: String
      default: recon.txt

  executor:
    name: sh
    command: |
      export HISTCONTROL=ignoreboth
      ls #{evil_command} > #{output_file}