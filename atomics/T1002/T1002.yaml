---
attack_technique: T1002
display_name: Data Compressed

atomic_tests:
- name: Compress Data for Exfiltration With PowerShell
  description: |
    Compresses Data for Exfiltration via PowerShell
  supported_platforms:
    - windows
  input_arguments:
    input_file:
      description: |
        xxx
      type: Path
      default: "%TEMP%"
    output_file:
      description: |
        xxx
      type: Path
      default: C:\test\Data.zip
  executor:
    name: powershell
    command: |
      dir #{input_file} -Recurse | Compress-Archive -DestinationPath #{output_file}

- name: Compress Data for Exfiltration With Rar
  description: |
    Compresses Data for Exfilatration via Rar
  supported_platforms:
    - windows
  input_argument:
    output_file:
      type: String
      default: exfilthis.rar
    input_file:
      type: String
      default: "*.docx"

  executor:
    name: command_prompt
    command: |
      rar a -r #{output_file} #{input_file}